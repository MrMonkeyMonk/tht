#!/bin/bash

# zv = zeek viewer

# only output first x lines
lines="${1:-1000}"

# Rationale for piping to head is a large number of results is not useful to browse manually.
# On top of that, pspg waits until all input is available before displaying in order to calculate
# column widths and totals.

head -n "$lines" | zq -f csv - | pspg --csv --csv-header=on --vertical-cursor --freezecols=0

# faster option for TSV
#sed -e '0,/^#fields\t/s///' | grep -v '^#' | head -n 1000 | pspg --tsv --vertical-cursor --freezecols=0
# faster option for JSON
#head -n 1000 | mlr --j2c unsparsify then regularize | pspg --csv --csv-header=on --vertical-cursor --freezecols=0
# downside is having to know format ahead of time