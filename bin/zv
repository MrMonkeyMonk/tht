#!/bin/bash

# zv = zeek viewer

# only output first x lines
lines="${1:-1000}"

# Rationale for piping to head is a large number of results is not useful to browse manually.
# On top of that, pspg waits until all input is available before displaying in order to calculate
# column widths and totals.

# use fields line for headers, ignore all comment lines, and truncate to the first x lines
sed -e '0,/^#fields\t/s///' | grep -v '^#' | head -n "$lines" | pspg --tsv --vertical-cursor --freezecols=0
